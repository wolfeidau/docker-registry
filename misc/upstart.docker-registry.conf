description "docker-registry"
# dojo - nodejs service wrapper
#
# Generated by Chef for <%= node['fqdn'] %>
# Local modifications will be overwritten.
#
# dojo

start on (filesystem and net-device-up)
stop on runlevel [!2345]

env RUN_AS="docker-registry"
env LOG="/var/log/docker-registry.log"
env PID="/var/run/docker-registry.pid"

# app settings
env REGISTRY_DATA="/data/docker"
env REGISTRY_LISTEN=":80"

# Security Things
env REGISTRY_SECRET="SETTHISNOW"
env REGISTRY_PASS="SETTHISNOW"

limit nofile 32768 32768

# If the process quits unexpectadly trigger a respawn
respawn

# Start the process
exec start-stop-daemon --start --chuid $RUN_AS --make-pidfile --pidfile $PID --exec /usr/local/bin/docker-registry >> $LOG 2>&1